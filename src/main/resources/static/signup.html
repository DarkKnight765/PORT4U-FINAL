<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PORT4U – Sign Up</title>
    <link rel="stylesheet" href="./assets/styles/signup.css" />
  </head>
  <body>
    <div class="container">
      <div class="left-section">
        <h1>Your personal portfolio is just three clicks away</h1>
        <p>
          Create a stunning portfolio that showcases your skills and
          achievements.
        </p>
        <img src="./assets/img/signup.png" alt="Portfolio Illustration" />
      </div>

      <div class="right-section">
        <div class="logo">
         
          <img src="./assets/img/logo.png" alt="PORT4U Logo"
          />
        </div>
        <h2>Sign up to create your personal portfolio</h2>

        <div id="signup-container">
          <div class="form-group">
            <label for="username">Username:</label>
            <input
              type="text"
              id="username"
              placeholder="your username"
              required
            />
          </div>
          <div class="form-group">
            <label for="email">Email </label>
            <input
              type="email"
              id="email"
              placeholder="you@example.com"
              required
            />
          </div>
          <div class="form-group">
            <label for="password">Password:</label>
            <input
              type="password"
              id="password"
              placeholder="••••••••"
              required
            />
          </div>

          <button id="signup-btn" type="button" class="button">Sign up</button>
          <p id="feedback" style="display: none"></p>
          <p>Already have an account? <a href="/login.html">Login</a></p>
        </div>
      </div>
    </div>

<script>
  document
    .getElementById("signup-btn")
    .addEventListener("click", async () => {
      const fb = document.getElementById("feedback");
      fb.style.display = "block";
      fb.className = "";

      const username = document.getElementById("username").value.trim();
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value;

      // ✅ Validate fields before making the request
      if (!username || !email || !password) {
        fb.classList.add("error");
        fb.textContent = "❌ Please fill in all the required fields.";
        return;
      }

      // Optional: Basic email format check
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        fb.classList.add("error");
        fb.textContent = "❌ Please enter a valid email address.";
        return;
      }

      fb.textContent = "Signing up…";

      const payload = { username, email, password };

      try {
        const res = await fetch("/api/signup", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload),
        });
        const text = await res.text();

        if (res.ok) {
          fb.className = "success";
          fb.textContent = "✅ " + text;
          setTimeout(() => {
            window.location.href = "/login.html";
          }, 600);
        } else {
          fb.className = "error";
          fb.textContent = `❌ Signup failed (${res.status}): ${text}`;
        }
      } catch (err) {
        fb.className = "error";
        fb.textContent = "⚠️ Network error: " + err.message;
      }
    });
</script>

  </body>
</html>
